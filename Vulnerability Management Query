let A = DeviceTvmSoftwareVulnerabilities;
let B = DeviceTvmSoftwareVulnerabilitiesKB;
let Ab = A  | lookup (B) on CveId;
let VUL = DeviceInfo
| join Ab on DeviceName;
DeviceEvents
| join VUL on DeviceName
| sort by CvssScore
| where ActionType has_any ('ScheduledTaskCreated','AntivirusMalwareBlocked') 
| project CveId, IsExploitAvailable, VulnerabilitySeverityLevel, VulnerabilityDescription, DeviceName,
 CvssScore, JoinType, RecommendedSecurityUpdate, Timestamp, ReportId, ActionType
